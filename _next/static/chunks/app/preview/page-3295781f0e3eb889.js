(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[639],{65:function(e,r,t){Promise.resolve().then(t.bind(t,2983))},2983:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return Y}});var l=t(7437),i=t(8543),n=t(8654),s=t(658),a=t(5338),o=t(7893),d=t(793),c=t(9352),u=t(1563),h=t(7757),x=t(1002),f=t(7639),g=t(6873),v=t(7731),j=t(2961),m=t(4654),p=t(6383),Z=t(2265),b=t(1835),y=t(2347),C=t(7862),k=t(6218),w=t(5976),F=t(9230),E=t(3618),P=t(5716),D=t(7934),S=t(4851),I=t(8546),O=t(5328),W=t(6105),N=t(3549),V=t(8852),A=t(9437),L=t(1096),_=t.n(L),z=e=>{let{value:r,onChange:t,readOnly:i=!1,error:n=!1}=e,[s,o]=(0,Z.useState)(!1),[d,c]=(0,Z.useState)(null);if((0,Z.useEffect)(()=>{try{c(r?_()(r):null),o(!1)}catch(e){console.error("Date parsing error:",e),o(!0),c(null)}},[r]),s)return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.Z,{fullWidth:!0,type:"date",value:r||"",onChange:e=>!i&&t(e.target.value),InputProps:{readOnly:i},variant:"outlined",error:n,label:"Select date",InputLabelProps:{shrink:!0}}),(0,l.jsx)(a.Z,{severity:"info",sx:{mt:1},children:"Using fallback date input due to DatePicker initialization issue."})]});try{return(0,l.jsx)(V._C,{dateAdapter:A.y,children:(0,l.jsx)(N.M,{label:"Select date",value:d,onChange:e=>{try{if(e&&e.isValid()){let r=e.format("YYYY-MM-DD");c(e),t(r),o(!1)}else c(null),t(""),o(!1)}catch(e){console.error("Date change error:",e),o(!0)}},readOnly:i,slotProps:{textField:{fullWidth:!0,variant:"outlined",error:n}}})})}catch(e){return console.error("DatePicker render error:",e),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.Z,{fullWidth:!0,type:"date",value:r||"",onChange:e=>!i&&t(e.target.value),InputProps:{readOnly:i},variant:"outlined",error:n,label:"Select date",InputLabelProps:{shrink:!0}}),(0,l.jsx)(a.Z,{severity:"warning",sx:{mt:1},children:"DatePicker failed to load. Using fallback date input."})]})}},q=e=>{let{fields:r,formData:t,errors:n,onChange:c}=e,[h,f]=(0,Z.useState)(0),g=(0,Z.useMemo)(()=>[...r].sort((e,r)=>e.order-r.order),[r]),v=(0,Z.useCallback)(()=>{let e={};r.forEach(l=>{var i;if(null===(i=l.derivedConfig)||void 0===i?void 0:i.isDerived)try{let i=(0,W.E)(l,t,r),n=t[l.id];i!==n&&JSON.stringify(i)!==JSON.stringify(n)&&(e[l.id]=i)}catch(r){console.error("Error computing derived field ".concat(l.label,":"),r),void 0===t[l.id]&&(e[l.id]=l.defaultValue||"")}}),Object.keys(e).length>0&&Object.entries(e).forEach(e=>{let[r,t]=e;c(r,t)})},[r,t,c]);(0,Z.useEffect)(()=>{let e=setTimeout(()=>{v()},150);return()=>clearTimeout(e)},[v]),(0,Z.useEffect)(()=>{let e=()=>{f(e=>e+1)};return window.addEventListener("error",e),()=>window.removeEventListener("error",e)},[]);let j=e=>{var r;return null===(r=n.find(r=>r.fieldId===e))||void 0===r?void 0:r.message},m=e=>{var n,f,g,v,m,p;let Z=null!==(v=null!==(g=t[e.id])&&void 0!==g?g:e.defaultValue)&&void 0!==v?v:"";if(null===(n=e.derivedConfig)||void 0===n?void 0:n.isDerived)try{Z=(0,W.E)(e,t,r)}catch(r){console.error("Error rendering derived field ".concat(e.label,":"),r),Z=e.defaultValue||""}let N=j(e.id),V=null===(f=e.derivedConfig)||void 0===f?void 0:f.isDerived,A=r=>(0,l.jsx)(u.Z,{sx:{mb:3,transition:"all 0.2s",bgcolor:V?"primary.50":"white",border:N?2:1,borderColor:N?"error.main":V?"primary.light":"grey.300"},children:(0,l.jsx)(x.Z,{children:(0,l.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,l.jsxs)(i.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,l.jsx)(s.Z,{variant:"subtitle1",component:"label",sx:{fontWeight:"medium",color:e.required?"error.main":"text.primary","&::after":e.required?{content:'" *"',color:"error.main"}:{}},children:e.label}),(0,l.jsxs)(i.Z,{sx:{display:"flex",gap:1},children:[e.required&&(0,l.jsx)(d.Z,{label:"Required",color:"error",size:"small",variant:"outlined"}),V&&(0,l.jsx)(d.Z,{icon:(0,l.jsx)(O.Z,{}),label:"Auto-calculated",color:"secondary",size:"small",variant:"outlined"})]})]}),r,N&&(0,l.jsxs)(a.Z,{severity:"error",children:[(0,l.jsx)(o.Z,{children:"Validation Error"}),N]}),V&&!N&&(0,l.jsxs)(a.Z,{severity:"info",children:[(0,l.jsx)(O.Z,{sx:{mr:1}}),"This field is automatically calculated based on other form values."]})]})})},"".concat(e.id,"-").concat(h));try{switch(e.type){case"text":return A((0,l.jsx)(b.Z,{fullWidth:!0,value:String(Z||""),onChange:r=>!V&&c(e.id,r.target.value),InputProps:{readOnly:V},variant:"outlined",error:!!N}));case"number":return A((0,l.jsx)(b.Z,{fullWidth:!0,type:"number",value:Z||"",onChange:r=>!V&&c(e.id,Number.parseFloat(r.target.value)||0),InputProps:{readOnly:V},variant:"outlined",error:!!N}));case"textarea":return A((0,l.jsx)(b.Z,{fullWidth:!0,multiline:!0,rows:4,value:String(Z||""),onChange:r=>!V&&c(e.id,r.target.value),InputProps:{readOnly:V},variant:"outlined",error:!!N}));case"select":return A((0,l.jsxs)(y.Z,{fullWidth:!0,disabled:V,error:!!N,children:[(0,l.jsx)(C.Z,{children:"Select an option"}),(0,l.jsx)(k.Z,{value:String(Z||""),onChange:r=>!V&&c(e.id,r.target.value),label:"Select an option",children:null===(m=e.options)||void 0===m?void 0:m.map(e=>(0,l.jsx)(w.Z,{value:e.value,children:e.label},e.value))})]}));case"radio":return A((0,l.jsxs)(y.Z,{component:"fieldset",disabled:V,error:!!N,children:[(0,l.jsx)(F.Z,{component:"legend",children:e.label}),(0,l.jsx)(E.Z,{value:String(Z||""),onChange:r=>!V&&c(e.id,r.target.value),children:null===(p=e.options)||void 0===p?void 0:p.map(e=>(0,l.jsx)(P.Z,{value:e.value,control:(0,l.jsx)(D.Z,{}),label:e.label},e.value))})]}));case"checkbox":return A((0,l.jsx)(S.Z,{children:(0,l.jsx)(P.Z,{control:(0,l.jsx)(I.Z,{checked:!!Z,onChange:r=>!V&&c(e.id,r.target.checked),disabled:V}),label:e.label})}));case"date":return A((0,l.jsx)(z,{value:Z,onChange:r=>!V&&c(e.id,r),readOnly:V,error:!!N}));default:return A((0,l.jsxs)(a.Z,{severity:"warning",children:[(0,l.jsx)(o.Z,{children:"Unsupported Field Type"}),'Field type "',e.type,'" is not supported.']}))}}catch(r){return console.error("Error rendering field ".concat(e.label,":"),r),A((0,l.jsxs)(a.Z,{severity:"error",children:[(0,l.jsx)(o.Z,{children:"Field Render Error"}),"Unable to render this field. Please check the field configuration."]}))}};return 0===r.length?(0,l.jsxs)(a.Z,{severity:"info",children:[(0,l.jsx)(o.Z,{children:"No Fields to Display"}),"No fields to display. Add some fields in the form builder to see the preview."]}):(0,l.jsx)(i.Z,{children:g.map(e=>m(e))},h)},T=t(7610),M=t(2113);let R=(e,r)=>{for(let t of e.validationRules)switch(t.type){case"required":if(!r||"string"==typeof r&&""===r.trim())return t.message;break;case"minLength":if("string"==typeof r&&r.length<(t.value||0))return t.message;break;case"maxLength":if("string"==typeof r&&r.length>(t.value||0))return t.message;break;case"email":let e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if("string"==typeof r&&!e.test(r))return t.message;break;case"password":if("string"==typeof r&&(r.length<8||!/\d/.test(r)))return t.message}return null},U=(e,r)=>{let t=[];return e.forEach(e=>{let l=r[e.id],i=R(e,l);i&&t.push({fieldId:e.id,message:i})}),t};var Y=()=>{let e=(0,T.T)(),{currentForm:r,formData:t,errors:Z}=(0,T.C)(e=>e.formBuilder),{enqueueSnackbar:b}=(0,m.Ds)();return 0===r.fields.length?(0,l.jsx)(p.Z,{children:(0,l.jsx)(i.Z,{sx:{textAlign:"center",py:8},children:(0,l.jsxs)(n.Z,{sx:{p:6,maxWidth:600,mx:"auto",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:[(0,l.jsx)(g.Z,{sx:{fontSize:60,mb:2,opacity:.8}}),(0,l.jsx)(s.Z,{variant:"h3",component:"h1",fontWeight:"bold",gutterBottom:!0,children:"Form Preview"}),(0,l.jsxs)(a.Z,{severity:"info",sx:{mt:3,bgcolor:"rgba(255,255,255,0.1)",color:"white"},children:[(0,l.jsx)(o.Z,{sx:{color:"white"},children:"No Form to Preview"}),"No form to preview. Please create a form first by adding some fields."]})]})})}):(0,l.jsx)(p.Z,{children:(0,l.jsxs)(i.Z,{children:[(0,l.jsxs)(n.Z,{sx:{p:4,mb:4,textAlign:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:[(0,l.jsxs)(i.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:2},children:[(0,l.jsx)(g.Z,{sx:{fontSize:40,mr:1}}),(0,l.jsx)(s.Z,{variant:"h3",component:"h1",fontWeight:"bold",children:"Form Preview"})]}),r.name&&(0,l.jsxs)(i.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[(0,l.jsx)(s.Z,{variant:"h5",children:r.name}),(0,l.jsx)(d.Z,{label:"".concat(r.fields.length," fields"),sx:{bgcolor:"rgba(255,255,255,0.2)",color:"white"}})]})]}),(0,l.jsxs)(c.Z,{container:!0,spacing:4,children:[(0,l.jsx)(c.Z,{item:!0,xs:12,lg:8,children:(0,l.jsxs)(u.Z,{sx:{border:2,borderColor:"primary.light"},children:[(0,l.jsx)(h.Z,{title:(0,l.jsxs)(i.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,l.jsx)(s.Z,{variant:"h6",children:"Live Form Preview"}),Z.length>0&&(0,l.jsx)(d.Z,{icon:(0,l.jsx)(v.Z,{}),label:"".concat(Z.length," errors"),color:"error",variant:"outlined"})]})}),(0,l.jsx)(x.Z,{children:(0,l.jsx)(q,{fields:r.fields,formData:t,errors:Z,onChange:(r,t)=>{e((0,M.Zv)({fieldId:r,value:t}))}})})]})}),(0,l.jsx)(c.Z,{item:!0,xs:12,lg:4,children:(0,l.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"column",gap:3,position:"sticky",top:24},children:[(0,l.jsxs)(u.Z,{children:[(0,l.jsx)(h.Z,{title:(0,l.jsx)(s.Z,{variant:"h6",children:"Form Validation"})}),(0,l.jsx)(x.Z,{children:(0,l.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,l.jsx)(f.Z,{variant:"contained",startIcon:(0,l.jsx)(j.Z,{}),onClick:()=>{let l=U(r.fields,t);e((0,M.B$)(l)),0===l.length?b("Form is valid! All fields passed validation.",{variant:"success"}):b("Form has ".concat(l.length," validation error(s)"),{variant:"error"})},color:"primary",fullWidth:!0,children:"Validate Form"}),Z.length>0&&(0,l.jsx)(f.Z,{variant:"outlined",onClick:()=>{e((0,M.b9)()),b("Validation errors cleared",{variant:"success"})},fullWidth:!0,children:"Clear Errors"}),Z.length>0&&(0,l.jsxs)(a.Z,{severity:"error",children:[(0,l.jsx)(o.Z,{children:"Validation Errors"}),"Form has ",Z.length," validation error(s). Please fix them before submitting."]}),0===Z.length&&Object.keys(t).length>0&&(0,l.jsxs)(a.Z,{severity:"success",children:[(0,l.jsx)(o.Z,{children:"Form Valid"}),"Form validation passed! All fields are valid."]})]})})]}),(0,l.jsxs)(u.Z,{children:[(0,l.jsx)(h.Z,{title:(0,l.jsx)(s.Z,{variant:"h6",children:"Form Data (Debug)"})}),(0,l.jsx)(x.Z,{children:(0,l.jsx)(i.Z,{component:"pre",sx:{fontSize:"0.75rem",bgcolor:"grey.50",p:2,borderRadius:1,overflow:"auto",maxHeight:300,fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})]})})]})]})})}}},function(e){e.O(0,[869,815,590,236,391,168,568,603,971,117,744],function(){return e(e.s=65)}),_N_E=e.O()}]);